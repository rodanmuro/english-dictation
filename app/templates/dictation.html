{% extends "base.html" %}

{% block title %}Dictation · {{ title or 'Video' }}{% endblock %}

{% block content %}
  <section class="section">
    <h1 class="title">Dictation Practice</h1>
    <p class="subtitle">Video: {{ title or video_id }}</p>

    <div class="video-container">
      <div id="player"></div>
    </div>

    <div class="listening-hint" id="listeningHint">Listen carefully to the video segment…</div>

    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <button id="backButton" class="button">Previous Segment</button>
    <button id="replayButton" class="button primary">Replay Segment</button>

    <div class="input-container">
      <input
        type="text"
        id="dictationInput"
        class="dictation-input"
        placeholder="Start typing what you heard…"
        autocomplete="off"
        spellcheck="false"
        disabled
      />
    </div>

    <div class="success-message" id="successMessage">Great! Segment completed.</div>

    <div class="stats">
      <div class="stat-item">
        <div class="stat-value" id="progressStat">0%</div>
        <div class="stat-label">Progress</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="errorCount">0</div>
        <div class="stat-label">Errors</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="sentenceNumber">1</div>
        <div class="stat-label">Segment</div>
      </div>
    </div>
  </section>
{% endblock %}

{% block scripts %}
<script>
  window.VIDEO_ID = "{{ video_id }}";
  window.SEGMENTS = {{ (segments or []) | tojson }};
  window.PAGE_CONTEXT = 'dictation';
</script>
<script src="https://www.youtube.com/iframe_api"></script>
<script src="{{ url_for('static', path='js/dictation.js') }}"></script>
{% endblock %}

